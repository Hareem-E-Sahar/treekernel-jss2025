p <- ggplot(long_data, aes(x = type, y = Value, fill = kernel)) +
geom_boxplot() +
facet_wrap(~ Metric, scales = "free_y") +
labs(x = "", y = "") +
scale_fill_manual(values = c(
"PTK"      = "pink",
"SSTK"     = "lightblue",
"STK"      = "lightgreen",
"TF-IDF"   = "orange",
"Codebert" = "khaki1"
)) +
theme_minimal() +
theme(
legend.title = element_blank(),
legend.position = "top"
)
print(p)
ggsave(outfile, p, width = 5.5, height = 6)
}
#threshold
plot_rq2_per_filter(
kernel_data = threshold_all,
tfidf     = tfidf,
codebert  = codebert_rq2,
outfile   = "~/treekernel-jss2025/plots/rq2/rq2-threshold.pdf"
)
#topk_threshold
plot_rq2_per_filter(
kernel_data = topk_threshold_all,
tfidf     = tfidf,
codebert  = codebert_rq2,
outfile   = "~/treekernel-jss2025/plots/rq2/rq2-topk-threshold.pdf"
)
#topk
plot_rq2_per_filter(
kernel_data = topk_all,
tfidf     = tfidf,
codebert  = codebert_rq2,
outfile   = "~/treekernel-jss2025/plots/rq2/rq2-topk.pdf"
)
#no filter
plot_rq2_per_filter(
kernel_data = no_filter_all,
tfidf     = tfidf,
codebert  = codebert_rq2,
outfile   = "~/treekernel-jss2025/plots/rq2/no-filter-topk.pdf"
)
library(dplyr)
library(ggplot2)
library(tidyr)
filecols <- c("Prec@5","Prec@10","MRR","MAP","kernel","time","seed","mode")
read_metrics <- function(path, type, filter) {
df <- read.csv(path, header = FALSE)
colnames(df) <- filecols
df <- df[df$mode == "normalized", ]
df$type   <- type
df$filter <- filter
return(df)
}
codebert <- read.csv("~/treekernel-jss2025/results_final/codebert-metrics.csv", header=FALSE, skip = 1)
codebert <-codebert %>% select(1,2,3,4,5,6,7)
colnames(codebert)<-c("Prec@5","Prec@10","MRR","MAP@100","MAP","type","time") # type is represented by experiment column for RQ2
codebert_rq2 <- codebert %>% select(1,2,3,4,6) #(MAP@100 but renamed to MAP)
colnames(codebert_rq2) <- c("Prec@5",	"Prec@10", "MRR",	"MAP", "type")
codebert_rq2$kernel <- "CodeBERT"
tfidf<-read.csv("~/treekernel-jss2025/results_final/RQ2/tfidf/metrics_RQ2_TF-IDF.csv",header=FALSE, skip = 1)
colnames(tfidf)<-c("Prec@5","Prec@10", "MRR","MAP","kernel","time","seed","type")
tfidf    <- tfidf%>%select (1,2,3,4,5,8)     #Prec@5, Prec@10, MRR, MAP, kernel, type
source("~/treekernel-jss2025/plots/rq2/RQ2-topk.R")
tfidf_type1 <- tfidf %>% filter(type == "T1")
tfidf_type2 <- tfidf %>% filter(type == "T2")
tfidf_type3 <- tfidf %>% filter(type == "T3")
codebert_type1 <- codebert_rq2 %>% filter(type == "T1")
codebert_type2 <- codebert_rq2 %>% filter(type == "T2")
codebert_type3 <- codebert_rq2 %>% filter(type == "T3")
combined_typedata <- bind_rows(topk_all, tfidf_type1, tfidf_type2, tfidf_type3, codebert_type1, codebert_type2, codebert_type3)
long_data_tfidf_codebert <- combined_typedata %>%
pivot_longer(cols = c(`Prec@5` ,`Prec@10`, MRR, MAP),
names_to = "Metric",
values_to = "Value")
View(long_data_tfidf_codebert)
long_data_tfidf_codebert <- combined_typedata %>%
rename(`MAP@100` = MAP) %>%
pivot_longer(
cols = c(`Prec@5`, `Prec@10`, MRR, `MAP@100`),
names_to = "Metric",
values_to = "Value"
)
View(long_data_tfidf_codebert)
rq2_topk <- ggplot(long_data_tfidf_codebert, aes(x = type, y = Value, fill = kernel)) +
geom_boxplot() +
facet_wrap(~ Metric, scales = "free_y") +  # Facet by Metric
labs(  x = "",y = "") +
scale_fill_manual(values = c("PTK" = "lightblue", "SSTK" = "lightgreen","STK" = "gray",
"TF-IDF"="pink","Code"="khaki1" )) +
theme_minimal() +
theme(legend.title = element_blank(),legend.position = "top")
ggsave("~/treekernel-jss2025/plots/rq2/rq2-topk.pdf", rq2_topk, width=5.5,height=6)
rq2_topk
rq2_topk <- ggplot(long_data_tfidf_codebert, aes(x = type, y = Value, fill = kernel)) +
geom_boxplot() +
facet_wrap(~ Metric, scales = "free_y") +  # Facet by Metric
labs(  x = "",y = "") +
scale_fill_manual(values = c("PTK" = "lightblue", "SSTK" = "lightgreen","STK" = "gray",
"TF-IDF"="pink","CodeBERT"="khaki1" )) +
theme_minimal() +
theme(legend.title = element_blank(),legend.position = "top")
rq2_topk
ggsave("~/treekernel-jss2025/plots/rq2/rq2-topk.pdf", rq2_topk, width=5.5,height=6)
library(dplyr)
library(ggplot2)
library(tidyr)
read_norm_metrics <- function(path,filter) {
mycolname <- c("Prec@5","Prec@10","MRR","MAP","kernel","time","seed","mode")
df <- read.csv(path, header = FALSE)
colnames(df) <- mycolname
df$filter<-filter
return(df[df$mode == "normalized", ])
}
#Topk
ptk_topk  <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_PTK_topk.csv","topk")
stk_topk  <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_STK_topk.csv","topk")
sstk_topk <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_SSTK_topk.csv","topk")
tfidf<-read.csv("~/treekernel-jss2025/results_final/RQ1/tfidf/metrics_RQ1_TFIDF.csv", header=FALSE, skip = 1)
colnames(tfidf)<-c("Prec@5","Prec@10","MRR","MAP","kernel","time","seed")
colnames(tfidf)<-c("Prec@5","Prec@10","MRR","MAP","kernel","time","seed")
tfidf    <- tfidf%>%select (1,2,3,4,5)     #Prec@5, Prec@10, MRR, MAP, kernel
cols <- c("Prec@5", "Prec@10", "MRR", "MAP")
codebert<-read.csv("~/treekernel-jss2025/results_final/codebert-metrics.csv",header=FALSE, skip = 1)
codebert <- codebert[, c(1,2,3,4,5,6,7)]
colnames(codebert) <- c("Prec@5","Prec@10","MRR","MAP@100","MAP","experiment","time")
codebert_rq1 <- codebert %>% filter(experiment == "rq1-pos")
codebert<-read.csv("~/treekernel-jss2025/results_final/codebert-metrics.csv",header=FALSE, skip = 1)
codebert <- codebert[, c(1,2,3,4,5,6,7)]
colnames(codebert) <- c("Prec@5","Prec@10","MRR","MAP@100","MAP","experiment","time")
codebert_rq1 <- codebert %>% filter(experiment == "rq1-pos")
codebert_rq1 <- codebert_rq1 %>% select(1,2,3,4)
colnames(codebert_rq1) <- c("Prec@5","Prec@10","MRR","MAP")
codebert_rq1$kernel <- "CodeBERT"
View(codebert_rq1)
topk_all <- bind_rows(ptk_topk, stk_topk, sstk_topk)
topk_all <- topk_all %>% select(1,2,3,4,5) #Prec@5, Prec@10, MRR, MAP, kernel
combined_data <-  bind_rows(topk_all, codebert_rq1, tfidf)
long_data <- combined_data %>%
rename(`MAP@100` = MAP) %>%
pivot_longer(cols = c(`Prec@5`,`Prec@10`, MRR, MAP),
names_to = "Metric",
values_to = "Value")
View(topk_all)
View(topk_all)
View(codebert_rq1)
View(tfidf)
combined_data <-  bind_rows(topk_all, codebert_rq1, tfidf)
long_data <- combined_data %>%
rename(`MAP@100` = MAP) %>%
pivot_longer(cols = c(`Prec@5`,`Prec@10`, MRR, MAP),
names_to = "Metric",
values_to = "Value")
long_data <- combined_data %>%
pivot_longer(cols = c(`Prec@5`,`Prec@10`, MRR, MAP),
names_to = "Metric",
values_to = "Value")
View(long_data)
codebert<-read.csv("~/treekernel-jss2025/results_final/codebert-metrics.csv", header=FALSE, skip = 1)
codebert <- codebert[, c(1,2,3,4,5,6,7)]
colnames(codebert) <- c("Prec@5","Prec@10","MRR","MAP@100","MAP","experiment","time")
codebert_rq1 <- codebert %>% filter(experiment == "rq1-pos")
codebert_rq1 <- codebert_rq1 %>% select(1,2,3,4)
colnames(codebert_rq1) <- c("Prec@5","Prec@10","MRR","MAP")
codebert_rq1$kernel <- "CodeBERT"
round(sapply(cols, function(col) mean(codebert_rq1[[col]])),2)
topk_all <- topk_all %>% select(1,2,3,4,5) #Prec@5, Prec@10, MRR, MAP, kernel
combined_data <-  bind_rows(topk_all, codebert_rq1, tfidf)
long_data <- combined_data %>%
pivot_longer(cols = c(`Prec@5`,`Prec@10`, MRR, MAP),
names_to = "Metric",
values_to = "Value")
View(long_data)
View(tfidf)
tfidf<-read.csv("~/treekernel-jss2025/results_final/RQ1/tfidf/metrics_RQ1_TFIDF.csv", header=FALSE)
colnames(tfidf)<-c("Prec@5","Prec@10","MRR","MAP","kernel","time","seed")
tfidf    <- tfidf%>%select (1,2,3,4,5)     #Prec@5, Prec@10, MRR, MAP, kernel
cols <- c("Prec@5", "Prec@10", "MRR", "MAP")
round(sapply(cols, function(col) mean(tfidf[[col]])),2)
round(sapply(cols, function(col) mean(tfidf[[col]])),2)
codebert<-read.csv("~/treekernel-jss2025/results_final/codebert-metrics.csv", header=FALSE, skip = 1)
topk_all <- topk_all %>% select(1,2,3,4,5) #Prec@5, Prec@10, MRR, MAP, kernel
combined_data <-  bind_rows(topk_all, codebert_rq1, tfidf)
long_data <- combined_data %>%
pivot_longer(cols = c(`Prec@5`,`Prec@10`, MRR, MAP),
names_to = "Metric",
values_to = "Value")
rq1_topk<-ggplot(long_data, aes(x = kernel, y = Value, fill = kernel)) +
geom_boxplot() +
facet_wrap(~ Metric, scales = "free_y") +  # Facet by Metric, adjust y-axis independently for each
labs( y = "",x = "") +
scale_fill_manual(values = c("PTK" = "lightblue",  "SSTK"="lightgreen", "STK" = "grey","TF-IDF"="pink","CodeBERT"="khaki")) +
theme_minimal() +
theme(legend.title = element_blank(),
axis.text.x = element_blank())
rq1_topk
long_data <- combined_data %>%
rename(`MAP@100` = MAP) %>%
pivot_longer(cols = c(`Prec@5`,`Prec@10`, MRR, MAP),
names_to = "Metric",
values_to = "Value")
View(combined_data)
long_data <- combined_data %>%
rename(`MAP@100` = MAP) %>%
pivot_longer(
cols = c(`Prec@5`, `Prec@10`, MRR, `MAP@100`),
names_to = "Metric",
values_to = "Value"
)
rq1_topk<-ggplot(long_data, aes(x = kernel, y = Value, fill = kernel)) +
geom_boxplot() +
facet_wrap(~ Metric, scales = "free_y") +  # Facet by Metric, adjust y-axis independently for each
labs( y = "",x = "") +
scale_fill_manual(values = c("PTK" = "lightblue",  "SSTK"="lightgreen", "STK" = "grey","TF-IDF"="pink","CodeBERT"="khaki")) +
theme_minimal() +
theme(legend.title = element_blank(),
axis.text.x = element_blank())
rq1_topk
ggsave("~/treekernel-jss2025/plots/rq1/rq1-topk.pdf", rq1_topk, width=5,height=4)
#No filter
ptk_no_filter  <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_PTK_no_filter.csv","no_filter")
stk_no_filter  <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_STK_no_filter.csv","no_filter")
sstk_no_filter <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_SSTK_no_filter.csv","no_filter")
# For each kernel compute mean
cols <- c("Prec@5", "Prec@10", "MRR", "MAP")
round(sapply(cols, function(col) mean(ptk_no_filter[[col]])),2)
round(sapply(cols, function(col) mean(stk_no_filter[[col]])),2)
round(sapply(cols, function(col) mean(sstk_no_filter[[col]])),2)
library(dplyr)
library(ggplot2)
library(tidyr)
read_norm_metrics <- function(path,filter) {
mycolname <- c("Prec@5","Prec@10","MRR","MAP","kernel","time","seed","mode")
df <- read.csv(path, header = FALSE)
colnames(df) <- mycolname
df$filter<-filter
return(df[df$mode == "normalized", ])
}
#No filter
ptk_no_filter  <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_PTK_no_filter.csv","no_filter")
stk_no_filter  <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_STK_no_filter.csv","no_filter")
sstk_no_filter <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_SSTK_no_filter.csv","no_filter")
# For each kernel compute mean
cols <- c("Prec@5", "Prec@10", "MRR", "MAP")
round(sapply(cols, function(col) mean(ptk_no_filter[[col]])),2)
round(sapply(cols, function(col) mean(stk_no_filter[[col]])),2)
round(sapply(cols, function(col) mean(sstk_no_filter[[col]])),2)
#PTK   &  0.68 & 0.62 & 0.82 & 0.20 & 11913 \\ #no filter
#STK   &  0.71 & 0.67 & 0.85 & 0.26 & 11315 \\ #no filter
#SSTK  &  0.64 & 0.60 & 0.78 & 0.20 & 11789 \\ #no filter
#TF-IDF& 0.66 & 0.61 & 0.79 & 0.35 & 165    \\final
#CodeBERT& 0.49  & 0.46 & 0.50 & 0.18 & 0.09
no_filter_all <- bind_rows(ptk_no_filter, stk_no_filter, sstk_no_filter)
#Topk
ptk_topk  <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_PTK_topk.csv","topk")
stk_topk  <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_STK_topk.csv","topk")
sstk_topk <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_SSTK_topk.csv","topk")
# For each kernel compute mean
round(sapply(cols, function(col) mean(ptk_topk[[col]])),2)
round(sapply(cols, function(col) mean(stk_topk[[col]])),2)
round(sapply(cols, function(col) mean(sstk_topk[[col]])),2)
#PTK     & 0.68  & 0.62 & 0.82 & 0.33 & 11913.50 \\ #topk
#STK     & 0.71  & 0.67 & 0.85 & 0.38 & 11315.10 \\ #topk
#SSTK    & 0.64  & 0.60 & 0.78 & 0.33 & 11789.30 \\ #topk
#TF-IDF  & 0.66  & 0.61 & 0.79 & 0.35             \\final
#CodeBERT& 0.49  & 0.46 & 0.50 & 0.18 &  0.09
topk_all <- bind_rows(ptk_topk, stk_topk, sstk_topk)
#threshold
ptk_threshold  <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_PTK_threshold.csv","threshold")
stk_threshold  <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_STK_threshold.csv","threshold")
sstk_threshold <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_SSTK_threshold.csv","threshold")
# For each kernel compute mean
round(sapply(cols, function(col) mean(ptk_threshold[[col]])),2)
round(sapply(cols, function(col) mean(stk_threshold[[col]])),2)
round(sapply(cols, function(col) mean(sstk_threshold[[col]])),2)
#PTK   & 0.68  & 0.62  &  0.82  &  0.20 & 11913.50 \\ #threshold
#STK   & 0.71  & 0.67  &  0.85  &  0.25 & 11315.10 \\ #threshold
#SSTK  & 0.49  & 0.44  &  0.62  &  0.10 & 11789.30 \\ #threshold This changed the most when prec denom was set to K and mrr condition was corrected
#TF-IDF  & 0.66  & 0.61 & 0.79 & 0.35             \\final
#CodeBERT& 0.49  & 0.46 & 0.50 & 0.18 &  0.09
threshold_all <- bind_rows(ptk_threshold, stk_threshold, sstk_threshold)
#topk_threshold
ptk_topk_threshold  <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_PTK_topk_threshold.csv","topk_threshold")
stk_topk_threshold  <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_STK_topk_threshold.csv","topk_threshold")
sstk_topk_threshold <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_SSTK_topk_threshold.csv","topk_threshold")
# For each kernel compute mean
round(sapply(cols, function(col) mean(ptk_topk_threshold[[col]])),2)
round(sapply(cols, function(col) mean(stk_topk_threshold[[col]])),2)
round(sapply(cols, function(col) mean(sstk_topk_threshold[[col]])),2)
#PTK   & 0.68  & 0.62  &  0.82  &  0.33 & 11913.50 \\ #topk_threshold
#STK   & 0.71  & 0.67  &  0.85  &  0.38 & 11315.10 \\ #topk_threshold
#SSTK  & 0.49  & 0.44  &  0.62  &  0.24 & 11789.30 \\ #topk_threshold
#TF-IDF  & 0.66  & 0.61 & 0.79 & 0.35              \\final
#CodeBERT& 0.49  & 0.46 & 0.50 & 0.18 &  0.09
topk_threshold_all <- bind_rows(ptk_topk_threshold, stk_topk_threshold, sstk_topk_threshold)
topk_all <- topk_all %>% select(1,2,3,4,5) #Prec@5, Prec@10, MRR, MAP, kernel
pvals <- c(
wilcox.test(ptk_topk$`Prec@5`,  stk_topk$`Prec@5`,        paired=TRUE)$p.value,
wilcox.test(ptk_topk$`Prec@5`,  sstk_topk$`Prec@5`,       paired=TRUE)$p.value,
wilcox.test(stk_topk$`Prec@5`,  sstk_topk$`Prec@5`,       paired=TRUE)$p.value,
wilcox.test(ptk_topk$`Prec@5`,  tfidf$`Prec@5`,           paired=TRUE)$p.value,
wilcox.test(stk_topk$`Prec@5`,  tfidf$`Prec@5`,           paired=TRUE)$p.value,
wilcox.test(sstk_topk$`Prec@5`, tfidf$`Prec@5`,          paired=TRUE)$p.value,
wilcox.test(ptk_topk$`Prec@5`,  codebert_rq1$`Prec@5`,    paired=TRUE)$p.value,
wilcox.test(stk_topk$`Prec@5`,  codebert_rq1$`Prec@5`,    paired=TRUE)$p.value,
wilcox.test(sstk_topk$`Prec@5`, codebert_rq1$`Prec@5`,   paired=TRUE)$p.value
)
p.adjust(pvals, method = "holm")
0.01757812 0.03710938 0.01757812 0.01757812 0.01757812 0.01757812 0.01757812 0.01757812 0.01757812
View(ptk_topk)
View(ptk_topk)
View(ptk_topk)
View(stk_topk)
View(sstk_topk)
View(tfidf)
View(codebert_rq1)
pvals <- c(
wilcox.test(ptk_topk$`Prec@5`,  stk_topk$`Prec@5`,        paired=TRUE)$p.value,
wilcox.test(ptk_topk$`Prec@5`,  sstk_topk$`Prec@5`,       paired=TRUE)$p.value,
wilcox.test(stk_topk$`Prec@5`,  sstk_topk$`Prec@5`,       paired=TRUE)$p.value,
wilcox.test(ptk_topk$`Prec@5`,  tfidf$`Prec@5`,           paired=TRUE)$p.value,
wilcox.test(stk_topk$`Prec@5`,  tfidf$`Prec@5`,           paired=TRUE)$p.value,
wilcox.test(sstk_topk$`Prec@5`, tfidf$`Prec@5`,          paired=TRUE)$p.value,
wilcox.test(ptk_topk$`Prec@5`,  codebert_rq1$`Prec@5`,    paired=TRUE)$p.value,
wilcox.test(stk_topk$`Prec@5`,  codebert_rq1$`Prec@5`,    paired=TRUE)$p.value,
wilcox.test(sstk_topk$`Prec@5`, codebert_rq1$`Prec@5`,   paired=TRUE)$p.value
)
p.adjust(pvals, method = "holm")
p.adjust(pvals, method = "bonferroni")
ptk_topk  <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_PTK_topk.csv","topk")
stk_topk  <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_STK_topk.csv","topk")
sstk_topk <- read_norm_metrics("~/treekernel-jss2025/results_final/RQ1/metrics_RQ1_SSTK_topk.csv","topk")
tfidf<-read.csv("~/treekernel-jss2025/results_final/RQ1/tfidf/metrics_RQ1_TFIDF.csv", header=FALSE)
colnames(tfidf)<-c("Prec@5","Prec@10","MRR","MAP","kernel","time","seed")
tfidf    <- tfidf%>%select (1,2,3,4,5)     #Prec@5, Prec@10, MRR, MAP, kernel
codebert<-read.csv("~/treekernel-jss2025/results_final/codebert-metrics.csv", header=FALSE, skip = 1)
codebert <- codebert[, c(1,2,3,4,5,6,7)]
colnames(codebert) <- c("Prec@5","Prec@10","MRR","MAP@100","MAP","experiment","time")
codebert_rq1 <- codebert %>% filter(experiment == "rq1-pos")
codebert_rq1 <- codebert_rq1 %>% select(1,2,3,4)
colnames(codebert_rq1) <- c("Prec@5","Prec@10","MRR","MAP")
codebert_rq1$kernel <- "CodeBERT"
pvals <- c(
wilcox.test(ptk_topk$`Prec@5`,  stk_topk$`Prec@5`,        paired=TRUE)$p.value,
wilcox.test(ptk_topk$`Prec@5`,  sstk_topk$`Prec@5`,       paired=TRUE)$p.value,
wilcox.test(stk_topk$`Prec@5`,  sstk_topk$`Prec@5`,       paired=TRUE)$p.value,
wilcox.test(ptk_topk$`Prec@5`,  tfidf$`Prec@5`,           paired=TRUE)$p.value,
wilcox.test(stk_topk$`Prec@5`,  tfidf$`Prec@5`,           paired=TRUE)$p.value,
wilcox.test(sstk_topk$`Prec@5`, tfidf$`Prec@5`,           paired=TRUE)$p.value,
wilcox.test(ptk_topk$`Prec@5`,  codebert_rq1$`Prec@5`,    paired=TRUE)$p.value,
wilcox.test(stk_topk$`Prec@5`,  codebert_rq1$`Prec@5`,    paired=TRUE)$p.value,
wilcox.test(sstk_topk$`Prec@5`, codebert_rq1$`Prec@5`,    paired=TRUE)$p.value
)
p.adjust(pvals, method = "holm")
p.adjust(pvals, method = "bonferroni")
pvals <- c(
wilcox.test(ptk_topk$`Prec@10`,  stk_topk$`Prec@10`,        paired=TRUE)$p.value,
wilcox.test(ptk_topk$`Prec@10`,  sstk_topk$`Prec@10`,       paired=TRUE)$p.value,
wilcox.test(stk_topk$`Prec@10`,  sstk_topk$`Prec@10`,       paired=TRUE)$p.value,
wilcox.test(ptk_topk$`Prec@10`,  tfidf$`Prec@10`,                 paired=TRUE)$p.value,
wilcox.test(stk_topk$`Prec@10`,  tfidf$`Prec@10`,                 paired=TRUE)$p.value,
wilcox.test(sstk_topk$`Prec@10`, tfidf$`Prec@10`,                paired=TRUE)$p.value,
wilcox.test(ptk_topk$`Prec@10`,  codebert_rq1$`Prec@10`,         paired=TRUE)$p.value,
wilcox.test(stk_topk$`Prec@10`,  codebert_rq1$`Prec@10`,         paired=TRUE)$p.value,
wilcox.test(sstk_topk$`Prec@10`, codebert_rq1$`Prec@10`,        paired=TRUE)$p.value
)
p.adjust(pvals, method = "holm")
p.adjust(pvals, method = "holm")
p.adjust(pvals, method = "bonferroni")
pvals <- c(
wilcox.test(ptk_topk$MRR,  stk_topk$MRR,        paired=TRUE)$p.value,
wilcox.test(ptk_topk$MRR,  sstk_topk$MRR,       paired=TRUE)$p.value,
wilcox.test(stk_topk$MRR,  sstk_topk$MRR,       paired=TRUE)$p.value,
wilcox.test(ptk_topk$MRR,  tfidf$MRR,           paired=TRUE)$p.value,
wilcox.test(stk_topk$MRR,  tfidf$MRR,           paired=TRUE)$p.value,
wilcox.test(sstk_topk$MRR, tfidf$MRR,           paired=TRUE)$p.value,
wilcox.test(ptk_topk$MRR,  codebert_rq1$MRR,    paired=TRUE)$p.value,
wilcox.test(stk_topk$MRR,  codebert_rq1$MRR,    paired=TRUE)$p.value,
wilcox.test(sstk_topk$MRR, codebert_rq1$MRR,    paired=TRUE)$p.value
)
p.adjust(pvals, method = "holm")
p.adjust(pvals, method = "bonferroni")
p.adjust(pvals, method = "bonferroni")
pvals <- c(
wilcox.test(ptk_topk$MAP,  stk_topk$MAP,        paired=TRUE)$p.value,
wilcox.test(ptk_topk$MAP,  sstk_topk$MAP,       paired=TRUE)$p.value,
wilcox.test(stk_topk$MAP,  sstk_topk$MAP,       paired=TRUE)$p.value,
wilcox.test(ptk_topk$MAP,  tfidf$MAP,           paired=TRUE)$p.value,
wilcox.test(stk_topk$MAP,  tfidf$MAP,           paired=TRUE)$p.value,
wilcox.test(sstk_topk$MAP, tfidf$MAP,           paired=TRUE)$p.value,
wilcox.test(ptk_topk$MAP,  codebert_rq1$MAP,    paired=TRUE)$p.value,
wilcox.test(stk_topk$MAP,  codebert_rq1$MAP,    paired=TRUE)$p.value,
wilcox.test(sstk_topk$MAP, codebert_rq1$MAP,    paired=TRUE)$p.value
)
p.adjust(pvals, method = "holm")
p.adjust(pvals, method = "bonferroni")
p.adjust(pvals, method = "bonferroni")
#compare Bonferroni-adjusted p-values to Î± = 0.05
0.0176 < 0.05
pvals <- c(
wilcox.test(ptk_topk$`Prec@10`,  stk_topk$`Prec@10`,        paired=TRUE)$p.value,
wilcox.test(ptk_topk$`Prec@10`,  sstk_topk$`Prec@10`,       paired=TRUE)$p.value,
wilcox.test(stk_topk$`Prec@10`,  sstk_topk$`Prec@10`,       paired=TRUE)$p.value,
wilcox.test(ptk_topk$`Prec@10`,  tfidf$`Prec@10`,                 paired=TRUE)$p.value,
wilcox.test(stk_topk$`Prec@10`,  tfidf$`Prec@10`,                 paired=TRUE)$p.value,
wilcox.test(sstk_topk$`Prec@10`, tfidf$`Prec@10`,                paired=TRUE)$p.value,
wilcox.test(ptk_topk$`Prec@10`,  codebert_rq1$`Prec@10`,         paired=TRUE)$p.value,
wilcox.test(stk_topk$`Prec@10`,  codebert_rq1$`Prec@10`,         paired=TRUE)$p.value,
wilcox.test(sstk_topk$`Prec@10`, codebert_rq1$`Prec@10`,        paired=TRUE)$p.value
)
pvals <- c(
wilcox.test(ptk_topk$`Prec@10`,  stk_topk$`Prec@10`,        paired=TRUE)$p.value,
wilcox.test(ptk_topk$`Prec@10`,  sstk_topk$`Prec@10`,       paired=TRUE)$p.value,
wilcox.test(stk_topk$`Prec@10`,  sstk_topk$`Prec@10`,       paired=TRUE)$p.value,
wilcox.test(ptk_topk$`Prec@10`,  tfidf$`Prec@10`,                 paired=TRUE)$p.value,
wilcox.test(stk_topk$`Prec@10`,  tfidf$`Prec@10`,                 paired=TRUE)$p.value,
wilcox.test(sstk_topk$`Prec@10`, tfidf$`Prec@10`,                paired=TRUE)$p.value,
wilcox.test(ptk_topk$`Prec@10`,  codebert_rq1$`Prec@10`,         paired=TRUE)$p.value,
wilcox.test(stk_topk$`Prec@10`,  codebert_rq1$`Prec@10`,         paired=TRUE)$p.value,
wilcox.test(sstk_topk$`Prec@10`, codebert_rq1$`Prec@10`,        paired=TRUE)$p.value
)
p.adjust(pvals, method = "holm")
p.adjust(pvals, method = "bonferroni")
p.adjust(pvals, method = "bonferroni")
library(dplyr)
library(ggplot2)
library(tidyr)
mycolname<-c("Prec@5", "Prec@10", "MRR", "MAP", "kernel",  "time", "seed", "mode")
load_size_metrics <- function(path, size_label, mycolname) {
df <- read.csv(path, header = FALSE)
colnames(df) <- mycolname
df$size <- size_label
df <- df[df$mode == "Normalized", ]   # keep only normalized
df <- select(df,-mode)
return(df)
}
# Small (< 6 LOC)
ptk_lessThan6LOC <- load_size_metrics(
"~/treekernel-jss2025/results_final/RQ3/Small/metrics_RQ3_Small_PTK_topk.csv",
"< 6", mycolname
)
sstk_lessThan6LOC <- load_size_metrics(
"~/treekernel-jss2025/results_final/RQ3/Small/metrics_RQ3_Small_SSTK_topk.csv",
"< 6", mycolname
)
stk_lessThan6LOC <- load_size_metrics(
"~/treekernel-jss2025/results_final/RQ3/Small/metrics_RQ3_Small_STK_topk.csv",
"< 6", mycolname
)
# Large (> 10 LOC)
ptk_moreThan10LOC <- load_size_metrics(
"~/treekernel-jss2025/results_final/RQ3/Small/Large/metrics_RQ3_Large_PTK_topk.csv",
"> 10", mycolname
)
sstk_moreThan10LOC <- load_size_metrics(
"~/treekernel-jss2025/results_final/RQ3/Large/metrics_RQ3_Large_SSTK_topk.csv",
"> 10", mycolname
)
# Large (> 10 LOC)
ptk_moreThan10LOC <- load_size_metrics(
"~/treekernel-jss2025/results_final/RQ3/Large/metrics_RQ3_Large_PTK_topk.csv",
"> 10", mycolname
)
sstk_moreThan10LOC <- load_size_metrics(
"~/treekernel-jss2025/results_final/RQ3/Large/metrics_RQ3_Large_SSTK_topk.csv",
"> 10", mycolname
)
stk_moreThan10LOC <- load_size_metrics(
"~/treekernel-jss2025/results_final/RQ3/Large/metrics_RQ3_Large_STK_topk.csv",
"> 10", mycolname
)
cols <- c("Prec@5", "Prec@10", "MRR", "MAP")
round(sapply(cols, function(col) mean(stk_lessThan6LOC[[col]])), 2)
round(sapply(cols, function(col) mean(ptk_lessThan6LOC[[col]])), 2)
round(sapply(cols, function(col) mean(sstk_lessThan6LOC[[col]])), 2)
round(sapply(cols, function(col) mean(stk_moreThan10LOC[[col]])), 2)
round(sapply(cols, function(col) mean(ptk_moreThan10LOC[[col]])), 2)
round(sapply(cols, function(col) mean(ptk_moreThan10LOC[[col]])), 2)
round(sapply(cols, function(col) mean(stk_moreThan10LOC[[col]])), 2)
round(sapply(cols, function(col) mean(sstk_moreThan10LOC[[col]])), 2)
tfidf<-read.csv("~/treekernel-jss2025/results_final/RQ3/metrics_RQ3_TFIDF.csv",header = FALSE)
mycolname<-c("Prec@5", "Prec@10", "MRR", "MAP", "kernel",  "time", "seed", "mode")
tfidf<-read.csv("~/treekernel-jss2025/results_final/RQ3/metrics_RQ3_TFIDF.csv",header = FALSE)
mycolname<-c("Prec@5", "Prec@10", "MRR", "MAP", "kernel",  "time", "seed", "mode")
tfidf<-read.csv("~/treekernel-jss2025/results_final/RQ3/metrics_RQ3_TFIDF.csv",header = FALSE)
colnames(tfidf) <- mycolname
mycolname<-c("Prec@5", "Prec@10", "MRR", "MAP", "kernel",  "time", "seed", "mode")
tfidf<-read.csv("~/treekernel-jss2025/results_final/RQ3/metrics_RQ3_TFIDF.csv",header = FALSE)
colnames(tfidf) <- mycolname
tfidf_small<- tfidf[tfidf$mode == "Small", ]
tfidf_large<- tfidf[tfidf$mode == "Large", ]
tfidf_small$size<-"< 6"
tfidf_large$size<-"> 10"
cols <- c("Prec@5", "Prec@10", "MRR", "MAP")
round(sapply(cols, function(col) mean(tfidf_small[[col]])), 2)
round(sapply(cols, function(col) mean(tfidf_large[[col]])), 2)
codebert<-read.csv("~/treekernel-jss2025/results/codebert-metrics.csv")[,1:6]
View(codebert)
codebert <- codebert[, -5] #exclude MAP@all
colnames(codebert) <- c("Prec@5", "Prec@10", "MRR", "MAP","experiment")
codebert$kernel <- "CodeBERT"
codebert_small <- codebert %>% filter(experiment == "small_method_positive")
View(codebert_small)
codebert_large <- codebert %>% filter(experiment == "large_method_positive")
round(sapply(cols, function(col) mean(codebert_small[[col]])), 2)
round(sapply(cols, function(col) mean(codebert_large[[col]])), 2)
combined_data <- bind_rows(ptk_lessThan6LOC, sstk_lessThan6LOC, stk_lessThan6LOC, ptk_moreThan10LOC, sstk_moreThan10LOC, stk_moreThan10LOC, tfidf_small, tfidf_large, codebert_small, codebert_large)
